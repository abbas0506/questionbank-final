delete from subtypes;
delete from chapters;

insert into subtypes(id, name, type_id,subject_id,tagname,created_at, updated_at )
select id, name, type_id,null, tagname, created_at, updated_at from temp.subtypes where language is null;

insert into subtypes(id, name, type_id,subject_id,tagname,created_at, updated_at )
select id, name, type_id,6, tagname, created_at, updated_at from temp.subtypes where language='en';

insert into subtypes(id, name, type_id,subject_id,tagname,created_at, updated_at )
select id, name, type_id,7, tagname, created_at, updated_at from temp.subtypes where language='ur';


insert into chapters
select * from temp.chapters;

delete from questions;

delete from db.questions;

insert into db.questions(id,user_id, book_id, chapter_no, chapter_id, type_id, subtype_id, statement, marks, frequency)
select id,user_id,book_id, chapter_no, 1, type_id, subtype_id, statement, marks, bise_frequency from temp.questions;

UPDATE db.questions q
JOIN db.chapters c ON q.book_id = c.book_id and q.chapter_no=c.chapter_no
SET q.chapter_id = c.id;

insert into questions(id,chapter_id, type_id, subtype_id, statement,marks, frequency)
SELECT id,chapter_id, type_id, subtype_id, statement,marks, frequency from db.questions;

delete from mcqs;
insert into mcqs
select * from temp.mcqs;